define("helperIframe",["helperLink"],function(t,a,e){function s(t){var a=new Date;a.setDate(a.getDate()+t);var e=a.getFullYear(),s=a.getMonth()+1>9?a.getMonth()+1:"0"+(a.getMonth()+1),l=a.getDate()>9?a.getDate():"0"+a.getDate();return e+"-"+s+"-"+l}function l(t){if(t){var a="",e="<tr><th>\u4f53\u9a8c\u8bfe\u65f6\u95f4</th><th>\u4f53\u9a8c\u8bfe\u72b6\u6001</th><th>\u5b66\u5458\u4fe1\u606f</th><th>\u8bfe\u7a0b\u6559\u6750</th><th>\u8054\u7cfb\u65b9\u5f0f</th><th>\u5907\u6ce8</th><th>\u64cd\u4f5c</th></tr>";$("#stuNum").html(t.length);for(var s=0;s<t.length;s++){var l=t[s].user_id,n=t[s].nick_name,i=t[s].mobile,c=t[s].trial_time,u=t[s].trial_status,h=t[s].course_name||"",p=t[s].remark,m="";p&&(m=t[s].remark[0].content);var f=!1,g="";f&&(g="dn");var v={type:0,acc:i};a+="<tr>",a+='<td class="col-1"><p>'+c+"</p></td>",a+='<td class="col-2"><p>'+u+"</p></td>",a+='<td class="col-3"><p><a class="helper-student link" target="_blank" href="http://crm.51talk.com/admin/user/user_detail_info.php?user_id='+l+'">'+n+"("+l+")</a></p></td>",a+='<td class="col-5"><p>'+h+"</p></td>",a+='<td class="col-6"><p>'+i+"</p></td>",a+='<td class="col-7"><p>'+m+"</p></td>",a+='<td class="col-9" data-userId='+l+'><p><span class="helper-edit" data-userId="'+l+'">\u4fee\u6539\u5907\u6ce8</span></p><p><span class="helper-call">\u6253\u7535\u8bdd</span></p><p><span class="helper-add helper-link '+g+'" data-action="addFriend" data-data='+JSON.stringify(v)+'>\u52a0\u5fae\u4fe1</span></p><p><span class="helper-sms" data-userid="'+l+'" data-mobile="'+i+'">\u53d1\u77ed\u4fe1</span></p></td>',a+="</tr>"}$(".table-control thead").html(e),$(".table-control tbody").html(a),$(".table-control").show(),r(),d(),o()}else $(".table-nodata").show()}function n(){$(".add-remind textarea").val(""),$(".add-remark").hide(),$(".set-time i").hasClass("cut")&&$(".set-time i").removeClass("cut")}function r(){$(".helper-edit").on("click",function(){var t=$(this).closest(".col-9").attr("data-userId");$("#addRemark").attr("data-id",t),$(".add-remark").show()})}function d(){$(".helper-call").on("click",function(){var t=$(this).closest(".col-9").attr("data-userId");$.ajax({url:"/Call/handCall",data:{user_id:t,wechat_id:window.parent.wxHeck.wxInit.wxData.localInfo.wechat_id},type:"POST",dataType:"json",success:function(t){return 1e4!=t.status?alert(t.message):void alert("\u62e8\u6253\u6210\u529f\uff01")}})})}function o(){var t=$(".send"),a=$(".close");$(".helper-sms").on("click",function(a){$(".sms-layer").attr("style","top:"+(a.clientY-110)+"px"),$(".sms").show(),t.attr("data-id",$(this).data("userid")),t.attr("data-mobile",$(this).data("mobile")),console.log("\u70b9\u51fb\u3010\u53d1\u77ed\u4fe1\u3011")}),a.on("click",function(){$(".sms").hide(),t.attr("data-id",""),t.attr("data-mobile",""),$(".sms textarea").val("")}),t.on("click",function(){var t=$("#smsCon").val(),a=$(".send").attr("data-id"),e=$(".send").attr("data-mobile");return t?t.length>50?alert("\u77ed\u4fe1\u5185\u5bb9\u8d85\u51fa\u5b57\u6570\u9650\u5236\uff01"):void $.ajax({url:"/SendSms/sendSms",type:"POST",dataType:"json",data:{mobile:e,msg:t,user_id:a},success:function(t){return console.log(t),1e4==t.status?($("#smsCon").val(""),$(".sms").hide(),alert(t.message)):void alert(t.message)}}):alert("\u8bf7\u8f93\u5165\u77ed\u4fe1\u5185\u5bb9\uff01")})}t("helperLink"),$.ajax({url:"/NewDispatchCc/getNewDispatchUser",type:"POST",dataType:"json",data:{admin_id:window.parent.wxHeck.wxInit.wxData.localInfo.admin_id,type:2},success:function(t){return 1e4!=t.status?alert(t.message):void l(t.message)},error:function(t){console.log(t)}}),$(".close-layer-btn-right").on("click",function(){$(".add-remark").hide()}),$(".follow-time").val(s(1));var i=new Date;i.getFullYear(),i.getMonth()+1,i.getDate();$(".set-time i").on("click",function(){$(".set-time i").hasClass("cut")?$(this).removeClass("cut"):$(this).addClass("cut")}),$("#addRemark").on("click",function(){var t=$(".add-remind textarea").val(),a=$(".follow-time").val(),e=$(this).attr("data-id");return console.log(t,a,e),t?void $.ajax({url:"/Remark/addNew",data:{user_id:e,content:t,follow_date:a},type:"POST",dataType:"json",success:function(t){return 1e4!=t.status?alert(t.message):(alert(t.message),n(),void $(".add-remark").hide())}}):alert("\u8bf7\u8f93\u5165\u5907\u6ce8\u4fe1\u606f\uff01")}),$("#concel").on("click",function(){n()})});