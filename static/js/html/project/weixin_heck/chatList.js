define("chatList",["layui","niceScroll"],function(e,a,t){function s(e){var a=new Date;a.setDate(a.getDate()+e);var t=a.getFullYear(),s=a.getMonth()+1,i=a.getDate();return t+"-"+s+"-"+i}function i(){$("body").on("click",".voice",function(){$("#music").attr("src",$(this).data("src"));var e=document.getElementById("music"),a=0;e.addEventListener("canplay",function(){a=parseInt(e.duration),a>0&&e.play(),console.log(a),setTimeout(function(){$(".voice").removeClass("voice-play")},1e3*(a-1))}),$(this).addClass("voice-play")})}function r(){layui.use("laydate",function(){var e=layui.laydate,a={min:e.now(),max:"2099-06-16 23:59:59",istoday:!1,choose:function(e){t.min=e,t.start=e}},t={min:e.now(),max:"2099-06-16 23:59:59",istoday:!1,choose:function(e){a.max=e}}})}function c(){var e=start_time,a=end_time;o(e,a)}function n(){var e=$("#stime").val(),a=$("#etime").val();o(e,a)}function l(){var e=b="";o(e,b)}function o(e,a){console.log(e,a),u.request("get","/AuthGroupStats/message",{start_time:e,end_time:a,terminal_id:terminal_id,wechat_id:wechat_id},function(e){d(e)})}function d(e){if(1e4!=e.status)return alert(e.message);var a=e.message,t=a.userInfo.user_name,s=a.list;s||($("#chatList").hide(),$("#noChat").show());for(var i="",r="",c="51\u541b",n=0;n<s.length;n++){var l=s[n].send_type,o=s[n].message_type,d=s[n].content,u=s[n].send_time;switch(i+=2==l?'<li class="mes-left">':'<li class="mes-right">',l){case"1":r="\u9ed1\u9e1f\u53d1\u9001";break;case"2":r="\u597d\u53cb\u53d1\u9001";break;case"3":r="\u5fae\u4fe1\u53d1\u9001";break;case"4":r="\u7cfb\u7edf\u53d1\u9001";break;case"5":r="\u4e2d\u8f6c\u53d1\u9001";break;default:r="\u5e38\u89c4\u53d1\u9001"}switch(i+='<dt><span class="name">',i+=2==l?t:c,i+='</span><span class="time">'+u+"</span>",i+='<span class="sender">'+r+"</span>",i+="</dt>",o){case"0":i+='<dd class="text">',i+=d;break;case"1":var v=d.split(",")[0];i+='<dd class="pic">',i+='<img src="'+v+'">';break;case"2":i+='<dd class="voice" data-src="'+d+'">';break;case"42":i+='<dd class="text">',i+="\u540d\u7247\u6d88\u606f";break;case"495":var m=JSON.parse(d);i+='<dd class="article"><a href="'+m.urlStr+'" target="_blank">',i+="<div><h4>"+m.title+"</h4>",i+="<p>"+m.desc+"</p></div>",i+='<div><img src="'+m.thumbUrl+'"></div>',i+="</a>";break;case"3000":var m=JSON.parse(d);i+='<dd class="article"><a href="'+m.link+'" target="_blank">',i+="<div><h4>"+m.title+"</h4>",i+="<p>"+m.introduction+"</p></div>",i+='<div><img src="'+m.icon+'"></div>',i+="</a>";break;case"5000":i+='<dd class="text">',i+=d;break;case"6001":var m=JSON.parse(d);i+='<dd class="vedio"><video controls><source src="'+m.url+'"></video>';break;case"6000":var m=JSON.parse(d);i+='<dd class="file"><a href="'+m.url+'" target="_blank">',i+="<div>"+m.title,i+='<em class="fileOther"></em></div><div>',i+=(m.size/1024).toFixed(2),i+="KB</div></a>";break;default:i+='<dd class="text">',i+=d}i+="</dd>",i+="</li>"}$("#chatList").html(i)}e("layui"),$.fn.chatScroll=function(){var e=$(this);return e.niceScroll({cursorcolor:"#686b71",autohidemode:!0,cursorwidth:7,cursorborderradius:"999px",cursorborder:0}),e};var u={request:function(e,a,t,s,i){$.ajax({url:a,type:e,data:t,dataType:"JSON",success:function(e){s(e)},error:i})}},v=$("#getChatList"),m=$("#getAllList");s(-2),s(-1);$("#stime").val(start_time),$("#etime").val(end_time),r(),i(),c(),v.on("click",function(){n()}),m.on("click",function(){l()})});