define("adminNew",["niceScroll","vm"],function(t,e,a){window.adminNew={},adminNew.returnData=function(t){for(var e=[],a={},i=0,o=t.length;o>i;i++){var r=t[i],n=r.id+"";e.push(n),a[n]={content:r.content,flag:r.flag,name:r.name,tagList:r.tagList}}return{resultArr:e,resultJson:a}},adminNew.getData=function(t,e){for(var a=[],i=0,o=t.length;o>i;i++){var r=t[i];name=$.trim(e[r].name),tagList=e[r].tagList.sort(),a.push({id:r,name:name,tagList:tagList})}return a},adminNew.creatNewArr=function(t){return t.slice()},adminNew.getQueryStr=function(t){var e=location.search.match(new RegExp("[?&]"+t+"=([^&]+)","i"));return null==e||e.length<1?"":e[1]},adminNew.doAjax=function(t){return $.ajax({url:t.url,data:t.data,type:"post",dataType:"json",success:function(e){"function"==typeof t.success&&t.success.apply(null,arguments)},complete:function(){"function"==typeof t.complete&&t.complete.apply(null,arguments)}})},adminNew.listMove=function(t,e,a){return adminNew.arrMove[a](t,e)},adminNew.arrMove={up:function(t,e){if(0!=e){var a=t.splice(e,1)[0];return t.splice(e-1,0,a),!0}},down:function(t,e){if(e!=t.length-1){var a=t.splice(e,1)[0];return t.splice(e+1,0,a),!0}}},adminNew.user_group=adminNew.getQueryStr("user_group"),adminNew.keyword_id=adminNew.getQueryStr("keyword_id"),adminNew.listData=adminNew.returnData(listData),adminNew.keywordData=adminNew.returnData(keywordData),adminNew._listDataArr=adminNew.creatNewArr(adminNew.listData.resultArr),adminNew.vm=new Vue({el:"body",data:{listData:adminNew.listData,keywordData:adminNew.keywordData,user_group:adminNew.user_group,keyword_id:adminNew.keyword_id,creatPop:{creat:!0,editid:"",show:!1,content:"",type:!!adminNew.keywordData.resultJson[adminNew.keyword_id]&&adminNew.keywordData.resultJson[adminNew.keyword_id].name||""},toolPop:{show:!1,editid:"",editvalue:"",layerShow:!1},labelList:function(){var t={},e=[];return $.map(lableSel,function(a,i){e.push(a.id),t[a.id]=a}),{resultJSON:t,resultArr:e}}(),labelLayer:"",labelShow:!1},methods:{returnArr:function(t,e){var a=$.map(t,function(t,a){return e[t].tag_name}).join(",");return a},setSel:function(t,e){var a=this.keywordData.resultJson[t].tagList,i=a.indexOf(e);i>-1?a.splice(i,1):a.push(e)},toolPopShow:function(){this.toolPop.show=!0,this.$nextTick(function(){$(".tool_content>ul").heckScroll()})},showSel:function(t){this.labelLayer==t?this.labelLayer="":(this.labelLayer=t,this.labelShow=!this.labelShow,this.$nextTick(function(){$(".showLay").focus()})),this.toolPop.editid=t,this.toolPop.editvalue=this.keywordData.resultJson[t].name},hideSel:function(){this.labelLayer=""},listDataDeal:function(t,e){this.creatPop.creat="add"==t,this.creatPop.creat||(this.creatPop.editid=e,this.creatPop.content=adminNew.listData.resultJson[e].content),this.creatPop.show=!0},listDataCreatHide:function(){this.creatPop.show=!1,this.creatPop.content=""},listDataCreatSure:function(){var t=this;if(content=$.trim(t.creatPop.content),""==content)return alert("\u8bf7\u8f93\u5165\u5185\u5bb9");var e=content.search(/{[^{}]*}/),a=content.match(/{[^{}]*}/g);if(null!=a&&(a.length>1||1==a.length&&0!=e))return alert("{}\u7684\u5185\u5bb9\u53ea\u80fd\u5728\u5185\u5bb9\u7684\u5f00\u5934\u90e8\u5206");var i=function(){return t.creatPop.creat?{url:"/Knowledge/add",data:{user_group:adminNew.user_group,keyword_id:adminNew.keyword_id,content:content}}:{url:"/Knowledge/edit",data:{id:t.creatPop.editid,content:content}}}(),o=$.extend({},i,{success:function(t){return 1e4!=t.status?alert(t.message):void window.location.reload()}});adminNew.doAjax(o)},listDataDel:function(t){window.confirm("\u786e\u5b9a\u5220\u9664\u8be5\u5185\u5bb9\u5417\uff1f")&&adminNew.doAjax({url:"/Knowledge/del",data:{id:t,user_group:adminNew.user_group},success:function(t){return 1e4!=t.status?alert(t.message):(alert("\u5220\u9664\u6210\u529f"),void window.location.reload())}})},listDataMove:function(t,e){var a=adminNew._listDataArr.slice();adminNew.listMove(adminNew._listDataArr,t,e)&&adminNew.doAjax({url:"/Knowledge/moveCardPush",data:{ids:adminNew._listDataArr.join(",")},success:function(i){1e4!=i.status?(alert("\u79fb\u52a8\u5931\u8d25"),adminNew._listDataArr=a):adminNew.listMove(adminNew.listData.resultArr,t,e)}})},keywordDataMove:function(t,e){adminNew.listMove(this.keywordData.resultArr,t,e)},keywordDataClosePop:function(){this.toolPop.editid="",this.keywordData=adminNew.returnData(keywordData),this.toolPop.show=!1},keywordDataDelet:function(t){return this.toolPop.editid?alert("\u8bf7\u5148\u5b8c\u6210\u5f53\u524d\u6807\u7b7e\u4fee\u6539\u518d\u64cd\u4f5c"):(this.keywordData.resultArr.$remove(t),void delete this.keywordData.resultJson[t])},keywordDataChange:function(t){return this.toolPop.editid?alert("\u8bf7\u5148\u5b8c\u6210\u5f53\u524d\u6807\u7b7e\u4fee\u6539\u518d\u64cd\u4f5c"):(this.toolPop.editid=t,this.toolPop.editvalue=this.keywordData.resultJson[t].name,void(this.keywordData.resultJson[t].flag=!0))},keywordDataClose:function(t){this.keywordData.resultJson[t].flag=!1,this.keywordData.resultJson[t].name=this.toolPop.editvalue,this.toolPop.editvalue="",this.toolPop.editid=""},keywordDataRight:function(t){var e=$.trim(this.keywordData.resultJson[t].name),a=this.keywordData.resultJson[t].tagList.length;return""==e?alert("\u4fee\u6539\u6807\u7b7e\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"):0==a?alert("\u9009\u62e9\u6807\u7b7e"):(this.keywordData.resultJson[t].flag=!1,this.toolPop.editvalue="",this.toolPop.editid="",!0)},keywordDataAdd:function(){if(this.toolPop.editid)return alert("\u8bf7\u5148\u5b8c\u6210\u5f53\u524d\u6807\u7b7e\u4fee\u6539\u518d\u64cd\u4f5c");var t="new"+(new Date).getTime();this.toolPop.editid=t,this.keywordData.resultArr.push(t),Vue.set(this.keywordData.resultJson,t,{name:"",flag:!0,isNew:!0,tagList:[]})},keywordDataSure:function(){if(this.toolPop.editid){var t=this.keywordDataRight(this.toolPop.editid);if(!t)return}if(this.toolPop.editid)return alert("\u8bf7\u5148\u5b8c\u6210\u5f53\u524d\u6807\u7b7e\u4fee\u6539\u518d\u64cd\u4f5c");var e=adminNew.getData(this.keywordData.resultArr,this.keywordData.resultJson),a=this;adminNew.doAjax({url:"/Knowledge/saveKeyword",data:{user_group:adminNew.user_group,data:e},success:function(t){return 1e4!=t.status?alert(t.message):(alert("\u4fdd\u5b58\u6210\u529f"),$.inArray(adminNew.keyword_id,a.keywordData.resultArr)>-1?window.location.reload():window.location.assign(window.location.href.split("&")[0]),void(a.labelLayer=""))}})}},filter:{showValue:function(t){var e=lableSel;$.map(e,function(e,a){return e.id==t?e.tag_name:void 0})}}}),$.fn.heckScroll=function(){var t=$(this);return t.niceScroll({cursorcolor:"#686b71",autohidemode:!0,cursorwidth:7,cursorborderradius:"999px",cursorborder:0}),t},$(".lable_inner").height($(".content_list").outerHeight()-$(".label_list").outerHeight()).css("visibility","visible")});